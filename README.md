# AI SQC Sampler - 統計的品質管理サンプリング計算ツール

## 📋 概要

AI SQC Samplerは、統計的品質管理（SQC）のAQL/LTPD設計を基盤とした抜取検査数計算アプリケーションです。Microsoft Accessデータベースと連携し、実務運用に最適化されたサンプリングサイズを計算します。

## 🚀 主要機能

### 1. 統計的サンプリング計算
- **AQL/LTPD設計**: 受入品質限界（AQL）とロット許容不良率（LTPD）に基づく計算
- **ハイブリッド方式**: ロットサイズに応じた動的調整
  - 小ロット: 高割合抜取
  - 中・大ロット: 有限母集団補正による最適化
- **OCカーブ表示**: 受入確率曲線の可視化
- **検査水準管理**: 緩和・標準・厳格検査の自動判定

### 2. データベース連携
- **Microsoft Access対応**: 不具合情報データベースとの連携
- **品番管理**: 過去の検査履歴に基づく品番リスト表示
- **履歴追跡**: 日付範囲指定による検査履歴の分析

### 3. 結果管理・エクスポート
- **計算結果表示**: 詳細な統計情報と推奨サンプルサイズ
- **テキストファイル出力**: 計算結果の保存・共有
- **進捗管理**: 計算処理のリアルタイム表示

## 🛠️ セットアップ

### 必要な環境
- **Python**: 3.8以上
- **Microsoft Access Driver**: ODBCドライバー
- **OS**: Windows 10/11（推奨）

### インストール手順

1. **リポジトリのクローン**
   ```bash
   git clone <repository-url>
   cd ai_sqc_sampler
   ```

2. **依存関係のインストール**
   ```bash
   pip install -r requirements.txt
   ```

3. **データベースの準備**
   - Microsoft Accessファイル（`.accdb`）を準備
   - 設定画面でデータベースパスを指定

4. **アプリケーションの起動**
   ```bash
   python main.py
   ```

## 📖 使用方法

### 基本的な計算手順

1. **品番の入力**
   - 検査対象の品番を入力
   - 「品番リスト」ボタンで過去の品番を参照可能

2. **ロットサイズの指定**
   - 検査対象の数量（ロットサイズ）を入力

3. **統計パラメータの設定**
   - **AQL (%)**: 受入品質限界（デフォルト: 0.25%）
   - **LTPD (%)**: ロット許容不良率（デフォルト: 1.0%）
   - **α (%)**: 生産者危険（デフォルト: 5.0%）
   - **β (%)**: 消費者危険（デフォルト: 10.0%）
   - **c値**: 許容不良数（デフォルト: 0）

4. **対象期間の指定**（任意）
   - 開始日・終了日を指定して履歴分析
   - 未入力の場合は全期間が対象

5. **計算実行**
   - 「🚀 計算実行」ボタンをクリック
   - 結果が表示されたら「📄 結果をテキストファイルに保存」で出力

### 高度な機能

#### OCカーブ表示
- 計算実行後、「📊 OCカーブ表示」ボタンで受入確率曲線を表示
- 品質水準と受入確率の関係を視覚的に確認

#### 検査水準管理
- 「📋 検査水準管理」ボタンで検査水準の判定と履歴を表示
- 過去の検査結果に基づく水準調整の提案

#### データベース接続テスト
- メニュー「ツール」→「データベース接続テスト」で接続確認

## ⚙️ 設定

### データベース設定
1. メニュー「ファイル」→「設定...」を選択
2. データベースファイルのパスを指定
3. その他の設定項目を調整

### 設定項目
- **データベースパス**: Microsoft Accessファイルの場所
- **ウィンドウサイズ**: アプリケーションの表示サイズ
- **デフォルト信頼度**: 計算時のデフォルト信頼度
- **デフォルトc値**: 許容不良数のデフォルト値

## 📊 計算理論

### AQL/LTPD設計
本ツールは以下の統計理論に基づいています：

- **AQL (Acceptable Quality Level)**: 受入品質限界
- **LTPD (Lot Tolerance Percent Defective)**: ロット許容不良率
- **α (Alpha)**: 第1種の誤り（良いロットを不合格にする確率）
- **β (Beta)**: 第2種の誤り（悪いロットを合格にする確率）

### サンプルサイズ計算
- **二項分布**: 無限母集団の場合
- **超幾何分布**: 有限母集団の場合
- **有限母集団補正**: ロットサイズに応じた調整

## 🔧 トラブルシューティング

### よくある問題

#### データベース接続エラー
- **原因**: Microsoft Access Driverが未インストール
- **解決策**: 
  1. Microsoft Access Database Engine 2016 Redistributableをインストール
  2. データベースファイルのパスが正しいか確認
  3. ファイルのアクセス権限を確認

#### 計算結果が表示されない
- **原因**: 入力値の範囲外またはデータベースに該当データなし
- **解決策**:
  1. 入力値を確認（ロットサイズ: 1-1,000,000）
  2. 品番がデータベースに存在するか確認
  3. 対象期間を調整

#### アプリケーションが起動しない
- **原因**: 依存関係の不足またはPython環境の問題
- **解決策**:
  1. `pip install -r requirements.txt`を実行
  2. Python 3.8以上を使用
  3. 管理者権限で実行

### ログファイル
- **セキュリティログ**: `security.log`にアクセス制御とエラー情報を記録

## 📁 ファイル構成

```
ai_sqc_sampler/
├── main.py                    # メインアプリケーション
├── gui.py                     # GUI画面定義
├── calculation_engine.py      # 統計計算エンジン
├── database.py               # データベース操作
├── config_manager.py         # 設定管理
├── validation.py             # 入力検証
├── ui_manager.py             # UI管理
├── progress_manager.py       # 進捗管理
├── product_list_manager.py   # 品番リスト管理
├── export_manager.py         # エクスポート機能
├── oc_curve_manager.py       # OCカーブ表示
├── inspection_level_manager.py # 検査水準管理
├── security_manager.py       # セキュリティ管理
├── settings_dialog.py        # 設定ダイアログ
├── constants.py              # 定数定義
├── statistics.py             # 統計計算
├── app_config.json           # 設定ファイル
├── requirements.txt          # 依存関係
└── README.md                 # このファイル
```

## 🔒 セキュリティ

### セキュリティ機能
- **入力値検証**: SQLインジェクション対策
- **ファイルアクセス制御**: 不正なファイルアクセスの防止
- **エラーメッセージサニタイズ**: 機密情報の漏洩防止
- **セキュリティログ**: 不正アクセスの記録

### 推奨事項
- データベースファイルは適切な権限で保護
- 定期的なセキュリティログの確認
- 最新版のPythonとライブラリの使用

## 📞 サポート

### ヘルプ機能
- アプリケーション内の「ヘルプ」メニューから基本情報を確認
- 「アプリケーション情報」でバージョン情報を表示

### 技術サポート
- エラーメッセージとログファイルを確認
- 設定ファイル（`app_config.json`）の内容を確認
- データベース接続テストを実行

## 📝 ライセンス

このプロジェクトは内部使用を目的としています。

## 🔄 更新履歴

### v1.0
- 初回リリース
- AQL/LTPD設計によるサンプリング計算
- Microsoft Accessデータベース連携
- OCカーブ表示機能
- 検査水準管理機能

---

**AI SQC Sampler** - 統計的品質管理による効率的なサンプリング計算を実現
