# AI SQC Sampler

統計的品質管理（SQC）の AQL / LTPD 設計をベースに、Microsoft Access データベースの実績値を活用してサンプリング検査数を算出するデスクトップアプリケーションです。PyInstaller で配布されるワンファイル実行形式を想定したユーザーガイドを以下に示します。

## 📦 配布パッケージ構成

配布ディレクトリには主に以下のファイルが含まれます。

- AI_SQC_Sampler.exe – アプリケーション本体（ワンファイル実行形式）
- config/ – 初期設定値を格納する JSON ファイル（任意）
- docs/ – 操作マニュアルや参考資料（任意）
- security.log – 実行時に生成されるセキュリティログ（必要に応じて出力）

> 開発用ソースコードが必要な場合は Git リポジトリを取得してくださいが、エンドユーザーは AI_SQC_Sampler.exe を実行するだけで利用できます。

## 🚀 初回起動と基本操作

1. AI_SQC_Sampler.exe を任意のフォルダーに配置してダブルクリックします。
2. 初回起動時は「ファイル > 設定…」から Access データベース（.accdb / .mdb）のパスを指定してください。
3. 品番・ロットサイズ・統計パラメータを入力し、🚀 計算実行 を押すと詳細結果が表示されます。
4. 結果は必要に応じて 📄 結果をテキストファイルに保存 で出力できます。

### 主な画面と機能

| セクション | 内容 |
|------------|------|
| 入力エリア | 品番、ロットサイズ、AQL / LTPD、α / β、c値、対象期間を入力 |
| 結果カード | 抜取検査数・過去不具合の注意喚起・検査水準などをカード形式で表示 |
| レビュー表 | 基本情報・統計パラメータ・データベース実績活用の調整内容を1つの表に集約 |
| 追加機能 | 📊 OCカーブ表示、📋 検査水準管理、品番リスト、代替案提案などを提供 |

### ⚙️ 設定ダイアログ

- ファイル > 設定… から Access データベースのパスと AQL / LTPD / α / β / c値のデフォルトを変更できます。
- デフォルトに戻す を押すとアプリ既定値（AQL 0.25%、LTPD 1.0%、α 5.0%、β 10.0%、c値 0）にリセットされます。

## 🧮 統計パラメータの例

| パラメータ | 推奨初期値 | 説明 |
|------------|-------------|------|
| AQL (%) | 0.25 | 受入品質限界 – 良品とみなす上限不良率 |
| LTPD (%) | 1.0 | ロット許容不良率 – 不良ロットを排除したい水準 |
| α (%) | 5.0 | 第1種の誤り – 良いロットを不合格とする確率 |
| β (%) | 10.0 | 第2種の誤り – 悪いロットを合格とする確率 |
| c値 | 0 | 抜取検査で許容する不良数 |

## 🔐 セキュリティメモ

- 入力値の検証とファイルアクセス制御をアプリ内で実装しています。
- security.log にアクセス拒否や例外情報を記録するため、利用環境に合わせて保管してください。
- ワンファイル版でも Microsoft Access ODBC ドライバが必要です。未インストールの場合は事前にセットアップしてください。

## 🧩 トラブルシューティング

| 症状 | チェック箇所 / 対処 |
|------|-----------------------|
| アプリが起動しない | ウイルス対策ソフトの隔離、Windows SmartScreen の許可設定を確認 |
| Access 接続エラー | ドライバの有無、指定パス、読み取り権限、ファイル共有状態を確認 |
| 抜取数が表示されない | 入力値（ロットサイズ・AQL / LTPD）と対象期間に該当データがあるか確認 |
| OC カーブが表示されない | 計算実行後であること、必要データがデータベースに存在することを確認 |

## 🏗 開発者向けメモ（任意）

- ソースコードを取得する場合は git clone 後、pip install -r requirements.txt で依存を導入してください。
- pyinstaller app.spec でワンファイル実行形式を生成できます。
- 主要モジュール構成
  - main.py – エントリーポイント兼コントローラ
  - gui.py – Tkinter ベースのメイン画面
  - ui_manager.py – カード／テーブル描画とメッセージ表示
  - calculation_engine.py – 統計計算エンジン（SciPy 利用）
  - database.py – Access との接続ラッパー

---
**AI SQC Sampler** – 統計的品質管理で検査効率を高めるデスクトップツール



## 📝 抜取数の丸め方について

ロジック上、抜取数は検査区分ごとに定めたロット比率で丸めています。具体的には、履歴補正で調整した AQL/LTPD をもとに算出した値に対し、強化=ロットの約60%、標準=約40%、緩和=約25% を下回らないよう `ceil` で切り上げ、同時に上限比率（強化90%、標準70%、緩和35%）を超えないよう制御しています。これにより、出力される抜取数は 1200／800／500 などの整数に揃います。厳格度が保てるように丸めている仕様であり、意図した挙動です。
